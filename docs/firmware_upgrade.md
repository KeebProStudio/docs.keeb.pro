# 刷写键盘固件


客制化键盘中刷写固件是以往比较经常的操作，因为以前想修改键盘的按键设置时，往往就是需要写入新的固件，以前键盘的固件时不能通过软件进行修改的（当然现在也有很多键盘仍是这种方式）。本站的准则之一是让客制化键盘尽可能地简单，这里的简单还应当包括键盘固件的刷写，但因为能制作客制化键盘的朋友们在知识技能上都各有千秋，所以在选用固件刷写式上会出现差别，这个差别往往会带来各式各样的刷写方式，在这里将说明比较常见的固件刷写方式，让各位在固件刷写时能够顺利完成。

键盘固件在刷写前，需要进入到特定的刷写模式，这个模式一般就是芯片固件的烧录方式，根据客制化键盘PCB作者和客制化已有方案等情况，刷写模式多种多样，下面详细介绍比较常见的3种方式。再次，强烈建议其他客制化键盘的PCB作者尽可能地使用能让用户使用便利的刷写模式，哪怕我们作为作者多花点时间去研究这些技术，我们也应让客制化键盘的使用体验更佳美好，目前最推荐的方式是：U盘模式。

## 如何进入刷写模式
键盘进入刷写模式与PCB设计和芯片程序有关，常见一般有短接法、特定键值法、按键插线法和在线进入法。

### 1.短接法
短接法是比较靠近芯片底层的方法，便利性不高，但却是最终保底的方法，当然有些PCB作者只能提供该方法。该方法在全新芯片上，只要PCB电路设置得当，就可实现，属于客制化键盘常见主控芯片底层的方法，该方法一般进入的是芯片DFU模式，具体与芯片有关。
该方法比较简单直接，根据需要，将键盘拆开，找到PCB中的`RESET`触点，根据具体PCB说明，在键盘连接计算机时，将该触点与`GND`或`VCC`进行短接，建议使用绝缘镊子，快速地短接3次。

> 因为该操作属于接触到电气的操作，请询问PCB作者后再进行，避免发生烧坏PCB乃至触电的意外发生。

### 2. 特定键值法
该方法实现方式比较简单，一般客制化键盘都可以使用，没有太大门槛。一般 TMK/QMK 键盘都能支持一个 `RST` 的按键，只要将某一个键设置为该键值，通过按下该键即可让键盘进入到刷写模式。该键可以设置在任何可达的键盘层，如果您的键盘不能进行实时改建或者实时改建使用比较困难，请务必将该键设置到键盘的非0层，并牢记（写在纸上）其点按步骤（即切换层和所在位置）。

### 3. 按键插线法
该方法在实现上有两种方式，一种是写入特制的Bootloader程序，该方法可认为是刷不死的方法；另外一种是 TMK/QMK 固件在初始化是判断特定按键的按下情况来进行判断是否跳转至刷写模式，该方法在固件出现错误或刷错固件时会失效，所以采用该方法的PCB作者要注意好区分，留好其他保底方法。

该按键与具体PCB作者预设值有关，常见的是键盘左上角的按键（也可能是一个旋钮），具体请参看PCB说明或联系其作者。使用方法就是断开键盘与计算机的连接（即拔下USB线），按住指定按键的同时将键盘接入计算机（即插入USB线），根据其内在跳转逻辑不同，可能在未松开制定按键时便会进入到刷写模式，建议时接入计算机1秒后松开制定键，然后查看是否进入。

### 4. 在线进入法
在线进入法为本站首创方法（待核实），该方法需要键盘在设计之初就加入考虑，需要键盘内置固件、连线工具合同配合方可完成该功能。同时该功能也是与内在固件相关，所以在PCB上也会有硬件级的保底设计。

使用方法就是将键盘连接计算机，使用本站配置工具连接键盘，然后点击界面上的对应的按钮即可。一般在支持在线进入法的键盘，同时也会支持短接法和特定键值法。

## U盘模式
U盘模式，该模式的使用难度和其名称一样容易理解，整个过程与使用U盘区别不大。简要步骤如下：

1. 按键盘对应说明进入至固件刷写模式，如果键盘使用的是U盘模式，进入成功后，计算机的动作与插入普通U盘一致，具体与计算机的操作系统有关。

2. 按使用普通U盘一样，将对应固件粘贴至新出现的U盘中即可，刷写完成后，U盘一般会自动断开并以普通键盘模式重新接入计算机。

> U盘的名称一般与键盘有关，各不相同，请随机应变。
>
> U盘显示的大小无具体实际意义，仅为虚拟大小，与实际大小无关。

## Hid模式

## 主控芯片DFU模式

-EOF-

最近更新：{docsify-updated}